# 设置生命周期规则

您可以通过生命周期规则来批量转换存储空间（Bucket）内对象（Object）的存储类型，也可以批量删除指定的Object和碎片（Part）。

-   生命周期规则配置完成后24小时内会被加载，加载后的24小时内会被执行，请确认无误后再保存规则。
-   删除Object的操作是不可逆的，请根据您的需求合理设置生命周期规则。
-   通过控制台最多可配置100条生命周期规则，如需配置更多条目，请通过ossutil或SDK配置。详情请参见[生命周期规则介绍](/intl.zh-CN/开发指南/对象/文件（Object）/文件生命周期/生命周期规则介绍.md)。

1.  登录[OSS管理控制台](https://oss.console.aliyun.com/)。

2.  单击**Bucket列表**，之后单击目标Bucket名称。

3.  单击**基础设置** \> **生命周期**，在**生命周期**区域单击**设置**。

4.  单击**创建规则**，在弹出的生命周期创建规则页面创建生命周期规则。

    -   存储空间未开启版本控制

        |参数|说明|
        |--|--|
        |**基本设置**|
        |**状态**|设置生命周期规则的状态，可选择**启动**或**禁用**。|
        |**策略**|选择匹配策略的Object，可选择**按前缀匹配**（按照Object名称前缀匹配），也可以选择**配置到整个Bucket**（直接匹配到整个存储空间）。 **说明：** 选择**按前缀匹配**时，可以配置多条不同前缀的生命周期规则；选择**配置到整个Bucket**则仅允许配置一条生命周期规则。 |
        |**前缀**|如果**策略**选择了**按前缀匹配**，则需要输入Object名称的前缀。例如，您需要匹配名称以img开头的Object，您可以输入img。|
        |**标签**|选中后配置正确的标签，可以让规则针对拥有指定标签Object生效。例如选择策略为**按前缀匹配**，设置前缀为img，并设置标签的键为a，值为1。则该规则将匹配所有名称以img开头，标签为a=1的Object。关于对象标签的更多信息请参见[对象标签](/intl.zh-CN/开发指南/对象/文件（Object）/管理文件/对象标签.md)。|
        |**清除策略**|
        |**文件过期策略**|选择Object过期策略，可选择**过期天数**、**过期日期**和**不启用**。当选择**不启用**时，文件过期策略不生效。|
        |**转换到低频访问型存储**|根据**文件过期策略**选择的**过期天数**或**过期日期**设定Object何时过期，Object过期后转为低频访问存储类型。         -   选择**过期天数**时：指定一个过期天数N，Object会在其最后修改时间的N天后过期，并在过期的第二天转换为低频访问存储类型。例如设置为30，则最后修改日期为2019-1-1的对象会在2019年2月1日被转换为低频访问存储类型。
        -   选择**过期日期**时：指定一个过期日期，最后修改时间在该日期之前的Object会全部过期，并转换为低频访问存储类型。例如设置为2019-1-1，最后修改日期在2019-1-1之前的Object会被转换为低频访问存储类型。
**说明：**

        -   当前存储类型为标准存储的Object才会被生命周期规则自动转为低频存储。
        -   存储类型转换后的计量计费规则，请参见[管理文件生命周期](/intl.zh-CN/开发指南/对象/文件（Object）/文件生命周期/生命周期规则介绍.mdsection_e1n_vlx_dgb)。 |
        |**转换到归档型存储**|根据**文件过期策略**选择的**过期天数**或**过期日期**设定Object何时过期，Object过期后转为归档存储类型。配置方式与**转换到低频访问型存储**一样。|
        |**转换到冷归档型存储**|根据**文件过期策略**选择的**过期天数**或**过期日期**设定Object何时过期，Object过期后转为冷归档存储类型。配置方式与**转换到低频访问型存储**一样。|
        |**删除文件**|根据**文件过期策略**选择的**过期天数**或**过期日期**设定Object何时过期，Object过期后会被删除。配置方式与**转换到低频访问型存储**一样。|
        |**清理碎片**|
        |**碎片过期策略**|设置对过期碎片执行的操作。可选择**过期天数**、**过期日期**和**不启用**。当选择**不启用**时，碎片过期策略不生效。 **说明：**

        -   每条生命周期规则中，**文件过期策略**和**碎片过期策略**至少设置一项。
        -   若选中**标签**，则无法配置**碎片过期策略**。 |
        |**删除碎片**|根据**碎片过期策略**选择的**过期天数**或**过期日期**设定碎片何时过期，碎片过期后会被删除。配置方式与**转换到低频访问型存储**一样。|

    -   存储空间已开启过版本控制

        若存储空间已开启过版本控制功能，您也可以对存储空间内文件的历史版本进行管理。关于版本控制的更多内容请参见[版本控制介绍](/intl.zh-CN/开发指南/数据安全/版本控制/版本控制介绍.md)。

        开启版本控制后，生命周期规则当前版本和清理碎片配置方式与未开启版本控制时基本一样，对于历史版本的操作如下。

        |参数|说明|
        |--|--|
        |**当前版本**|
        |**清理对象删除标记**|开启版本控制后，增加**清理对象删除标记**选项，其他选项与未开启版本控制时一样。选择**清理对象删除标记**后，如果当前对象仅有一个版本且为删除标记时，OSS将删除过期对象的删除标记。关于删除标记详情请参见[删除标记](/intl.zh-CN/开发指南/数据安全/版本控制/删除标记.md)。 |
        |**历史版本**|
        |**文件过期策略**|设置历史版本文件的过期策略，可选择**过期天数**和**不启用**。当选择**不启用**时，文件过期策略不生效。|
        |**转换到低频访问型存储**|设定一个过期天数N，历史版本的Object会在其被转换为历史版本的N天后过期，并在过期的第二天转换为低频访问存储类型。例如设置为30，则2019-1-1被转为历史版本的Object会在2019年2月1日被转换为低频访问存储类型。 **说明：**

        -   当前存储类型为标准存储的Object才会被生命周期规则自动转为低频存储。
        -   历史版本的Object可通过下一个版本的最后修改时间确定自己被转为历史版本的时间。 |
        |**转换到归档型存储**|设定一个过期天数N，Object会在其被转换为历史版本的N天后过期，并在过期的第二天转换为归档存储类型。配置方式与**转换到低频访问型存储**一样。|
        |**转换到冷归档型存储**|设定一个过期天数N，Object会在其被转换为历史版本的N天后过期，并在过期的第二天转换为冷归档存储类型。配置方式与**转换到低频访问型存储**一样。|
        |**删除文件**|设定一个过期天数N，Object会在其被转换为历史版本的N天后过期，并在过期的第二天被删除。配置方式与**转换到低频访问型存储**一样。 **说明：** 删除历史版本的操作也会对标记为删除标记的对象生效。 |

        如果生命周期规则指向当前版本的删除行为，OSS不会直接删除当前版本，而是将当前版本转为历史版本，并添加删除标记。如果生命周期规则指向历史版本的删除行为，则直接删除历史版本。

5.  单击**确定**。

    生命周期规则保存成功后，您可以在策略列表中查看已设置的生命周期规则，并进行相应的**编辑**或者**删除**操作。


