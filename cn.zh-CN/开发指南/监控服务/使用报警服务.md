# 使用报警服务 {#concept_opj_kzj_5db .concept}

本文主要介绍OSS监控服务控制台中报警规则的概览及配置方法。

在介绍OSS监控服务控制台之前，请先阅读云监控提供的监控服务文档，了解基本概念并进行报警联系人和报警联系组的配置。

-   [报警服务概览](../../../../../cn.zh-CN/用户指南/报警服务/报警服务概览.md#)
-   [报警联系人和联系组](../../../../../cn.zh-CN/用户指南/报警服务/报警联系人__报警联系组管理.md#)

因为OSS的报警规则是根据OSS监控项设置的，所以类似于OSS监控项的维度分类，将其分成两个报警维度：用户层级和Bucket层级。

## 报警规则页 {#section_nf3_4zj_5db .section}

[报警规则页](https://cloudmonitor.console.aliyun.com/#/cloud/alarmrules/oss//-----all-----/)是OSS监控报警相关的规则管理页面，您可以查看、修改、启用、禁用和删除对应的报警规则，而且能够查看该报警规则对应的历史报警情况。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4393/15505687011216_zh-CN.png)

-   单击对应报警规则的**查看**，可以查看该报警规则的内容。
-   单击对应报警规则的**修改**，就可以对该报警规则进行修改。
-   单击对应报警规则的**删除**，就可以删除该报警规则。选中多条报警规则，然后单击表格最下方的**删除**按钮，可以批量删除报警规则。
-   如果报警规则处于已启用状态，单击该报警规则的**禁用**，可以禁用该报警规则，报警规则失效，用户不能再收到对应的告警信息。选中多条报警规则，然后单击表格最下方的**禁用**按钮，可以批量禁用报警规则。
-   如果报警规则处于已禁用状态，单击该报警规则的**启用**，可以启用该报警规则，报警规则重新生效，能检测并发出对应的告警信息。选中多条报警规则，然后单击表格最下方的**启用**按钮，可以批量启用报警规则。
-   单击对应报警规则的**报警历史**，可以查看该报警规则历史发生的所有的告警情况。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4393/15505687026384_zh-CN.png)


相关概念:

-   报警历史指的是该报警规则的状态变化历史，比如从正常变成告警状态，是一个状态变化；从告警变成正常也是状态变化；还有一个特殊的状态变化：通道沉默。
-   当通知对象为**通道沉默**时，表示该报警规则触发告警之后的指定时间内一直满足报警触发状态\(即一直在告警，没有恢复到正常状态\)。此时，系统不向通知对象发送告警信息，直到通道沉默时间结束，才会有新的报警信息发送到通知对象。
-   报警历史信息能够保存一个月，即一个月之前的告警信息会被自动清理。查询时一次最多只能查询3天的数据，但不支持查询31天前的数据。

单击具体报警规则的通知对象后的**查看**，可以显示该通知对象（报警联系组）的成员以及每个成员接收告警信息的方式（短信、邮箱或者旺旺），如下图所示：

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4393/15505687026385_zh-CN.jpg)

## 查看报警规则 {#section_h25_xrt_q2b .section}

-   快速定位报警规则

    根据报警规则页中下面的控件信息能够快速定位到被搜索的报警规则:

    -   报警维度下拉框: 全部和Bucket层级。当选项为全部时，显示所有用户层级和Bucket层级的报警规则。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4393/15505687026386_zh-CN.png)

    -   Bucket下拉框：当报警维度下拉框为Bucket层级时，这里可以罗列该账号下所有的Bucket。选择对应的Bucket，可以展示属于该Bucket的所有报警规则。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4393/15505687026387_zh-CN.png)

    -   监控项下拉框：罗列所有的OSS的监控项，包括用户层级和Bucket层级的监控项。当选项为监控项时，显示用户层级或者Bucket层级所有监控项的报警规则。
    -   报警状态下拉框：报警状态、告警和正常。当为报警状态时显示所有状态的报警规则。
    -   启用状态下拉框：启用状态、已禁用和已启用。当为启用状态时，显示所有状态的报警规则。
-   查看全部报警规则

    单击**报警规则**Tab页进入报警规则也默认显示全部报警规则。将报警维度下拉框设置为全部，即能显示全部报警规则。配合监控项、报警状态和启用状态这三个下拉框能够更精确定位全部维度下的报警规则。

-   查看特定Bucket的报警规则

    如果需要查看某个特定的Bucket的报警规则，需要设置报警维度下拉框为Bucket层级，然后在Bucket下拉框中选择对应的Bucket名称。通过**Bucket列表**中的对应Bucket的**报警规则**进入的报警页，就能显示该Bucket的所有的报警规则。配合监控项、报警状态和启用状态这三个，即能显示该报警维度下更精确的报警规则。

-   查看与具体监控项相关的报警规则

    设置监控项下拉框为具体的某项监控项，就能显示对应监控项的所有报警规则。

-   查看指定报警状态的报警规则

    设置报警状态下拉框为指定报警状态，如告警，就能展示所有处于该告警状态的报警规则。

-   查看指定启用状态的报警规则

    设置启动状态下拉框为指定启用状态，如已禁用，就能显示已经被禁用的所有的报警规则。


## 添加报警规则 {#section_os1_yrt_q2b .section}

1.  进入创建报警规则页面，您可以通过如下方式进入：
    -   在[用户概况Tab页](https://cloudmonitor.console.aliyun.com/#/cloud/overview/oss/)单击**服务监控总览**任意图表内的![](https://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/internal/oss/0.0.4/assets/image/media/alert_chart.jpg)按钮。
    -   在[Bucket列表Tab页](https://cloudmonitor.console.aliyun.com/#/cloud/buckets/oss/)选中指定的Bucket，之后单击**创建报警规则**按钮。
    -   在[Bucket列表Tab页](https://cloudmonitor.console.aliyun.com/#/cloud/buckets/oss/)选中指定的Bucket，之后单击**服务监控总览**任意图表内的![](https://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/internal/oss/0.0.4/assets/image/media/alert_chart.jpg)按钮。

        ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/4393/155056870238977_zh-CN.png)

2.  根据需求配置报警规则。

    -   **关联资源**
        -   产品：选择对象存储OSS。
        -   资源范围：根据您的需求选择全部资源或Bucket维度。
        -   Bucket（针对Bucket维度）：选择指定的Bucket，可一次选中多个Bucket。
    -   **设置报警规则**
        -   规则名称：自定义。
        -   规则描述：根据需要选择监控的内容、时间及数值。
        -   **+添加报警规则**：单击可添加多条规则。
        -   通道沉默时间：报警发生后如果未恢复正常，间隔多久重复发送一次报警通知。
        -   连续几次超过阈值后报警：即连续几次报警的探测结果符合您设置的规则描述，才会触发报警。例如：设置的规则描述为“一分钟内公网流出量大于100MBytes，连续3次超过阈值后报警”。则连续出现3次一分钟内公网流出量大于100MBytes的情况，才会触发报警。
        -   生效时间：选择报警规则的生效时间。
    -   **通知方式**
        -   **通知对象**：若事先已经按照[报警联系人和联系组](../../../../../cn.zh-CN/用户指南/报警服务/报警联系人__报警联系组管理.md#)设置好报警联系组，直接选择对应的联系人组；若没有设置过报警联系人组，则单击**快创建联系人组**，按照提示创建即。
        -   报警级别：择报警规则的通知方式，其中**电话+短信+邮件+钉钉机器人**需[购买电话报警资源包](https://common-buy.aliyun.com/?commodityCode=cms_call_num#/buy)后才可使用。
        -   邮件主题：设置通知邮件的主题。
        -   邮件备注（可选）:设置邮件备注信息。
        -   报警回调:填写公网可访问的URL，云监控会将报警信息通过POST请求推送到该地址，目前仅支持HTTP协议。
    。

3.  单击**确认**，完成报警规则的设置。

## 注意事项 {#section_jt1_x2k_5db .section}

目前属于某个Bucket的报警规则存在性并没有与该Bucket的存在性强关联，即如果删除了某个Bucket，属于这个Bucket的报警规则依然存在。建议您在删除Bucket之前先删除对应的报警规则。

